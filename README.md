# openapi-scripts
Scripts used in postprocessing OpenAPI document for ReDoc.

## Postprocess the JSON file generated by `bufbuild/buf`

### dereference

Use [@apidevtools/json-schema-ref-parser](https://github.com/APIDevTools/json-schema-ref-parser) to dereference the auto-generated JSON file.

### Generate code sample

Use [openapi-snippet](https://github.com/ErikWittern/openapi-snippet) to generate code samples automatically.

### Convert the example and default values of integer type to int

A `int32` type `port` defined in the `.proto` file is:

```proto
int32 port = 1 [(grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
    format: "int32",
    default: "8080",
    example: "8080"
```

The default JSON generated by `bufbuild/buf` is:

```json
"port": {
  "type": "integer",
  "format": "int32",
  "example": 8080,
  "default": "8080"
}
```

`replaceint.js` replaces all integer values and the processed JSON file is:

```json
"port": {
  "type": "integer",
  "format": "int32",
  "example": 8080,
  "default": 8080
}
```

### Import markdown files

Embed external Markdown file contents to the `info.description` auto-generated JSON file. See [Redoc documentation](https://redocly.com/docs/api-reference-docs/guides/embedded-markdown/) for more information.

### Add `x-logo`

[`x-logo`](https://github.com/Redocly/redoc/blob/master/docs/redoc-vendor-extensions.md#x-logo) is a [vendor extension](https://swagger.io/specification/#specificationExtensions) from Redoc. It allows you to show a custom logo on the left upper corner of your redoc output.
